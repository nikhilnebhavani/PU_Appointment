(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[710],{21052:function(e,t,a){Promise.resolve().then(a.bind(a,59829))},59829:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(57437),i=a(10694),s=a.n(i);a(33145);var l=a(16512),o=a(2265),r=a(85994),c=a.n(r);a(21005);var m=a(17220),d=a(99376),p=a(64131);let _=a(77398),u={control:e=>({...e,backgroundColor:"#EFF2F5",border:"none",outline:"0px",cursor:"pointer"}),menu:e=>({...e,padding:"1% 1%"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"black":"#EFF2F5",color:t.isSelected?"white":"black",borderRadius:"10px",margin:"2% 0","&:hover":{backgroundColor:"black",cursor:"pointer",color:"white"}})};function h(){let e="https://appointment.paruluniversity.ac.in/back",t=(0,o.useMemo)(()=>{let e=new Date;return e.setHours(0,0,0,0),e},[]),a=(0,d.useRouter)(),[i,r]=(0,o.useState)("10:00"),[h,w]=(0,o.useState)([]),[f,g]=(0,o.useState)(()=>t.toISOString().split("T")[0]),[b,x]=(0,o.useState)([new Date]),v=new Date(t);v.setDate(t.getDate()+30);let[j,S]=(0,o.useState)(new Date(t.getFullYear(),t.getMonth(),t.getDate(),9,0)),[H,k]=(0,o.useState)([new Date(t.getFullYear(),t.getMonth(),t.getDate(),9,0),new Date(t.getFullYear(),t.getMonth(),t.getDate(),12,0),new Date(t.getFullYear(),t.getMonth(),t.getDate(),15,0)]),[D,y]=(0,o.useState)(""),[C,N]=(0,o.useState)(""),[T,O]=(0,o.useState)(""),[E,M]=(0,o.useState)(""),[P,F]=(0,o.useState)([]),[Y,B]=(0,o.useState)([]),[I,J]=(0,o.useState)(""),[q,A]=(0,o.useState)(""),[W,Z]=(0,o.useState)(""),[K,R]=(0,o.useState)(""),[G,X]=(0,o.useState)(""),[Q,V]=(0,o.useState)("00:15"),[z,L]=(0,o.useState)("offline"),[U,$]=(0,o.useState)(!1),[ee,et]=(0,o.useState)("both");(0,o.useEffect)(()=>{let t=p.Z.get("token");(async()=>{if(null!=t)try{let a=await fetch("".concat(e,"/newapp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokens:t})});if(200!=a.status)throw Error("HTTP error! Status: ".concat(a.status));let n=await a.json();if(n.a.length>0){let e=[];n.a.map(t=>{e.push({label:t.name,value:t.id,detail:t.datesAndtimes,email:t.email,number:t.number})}),w(e)}B(n.datesAndtimes),Z(n.name),R(n.phone),A(n.email)}catch(e){alert(e)}})()},[]),(0,o.useEffect)(()=>{let e=e=>e.map(e=>new Date(e.date)).filter(e=>e>=t),a=[];if("me"===ee)a=e(Y);else if("both"===ee){let t=e(Y),n=e(P);a=t.filter(e=>n.some(t=>e.getTime()===t.getTime()))}else a=e(P);x(a),a.length>0?g(a[0].toISOString().split("T")[0]):console.error("No dates available.")},[Y,ee,P,t]),(0,o.useEffect)(()=>{let e=()=>{k(function(e,t,a,n,i,s){let l=e=>{var t;return(null===(t=e.find(e=>e.date===n))||void 0===t?void 0:t.freeSlots)||[]},o=[];if("me"===a)o=l(e);else if("member"===a)o=l(t);else if("both"===a){let a=l(e),n=l(t);o=[],a.forEach(e=>{n.forEach(t=>{let a=_.max(_(e.start,"HH:mm"),_(t.start,"HH:mm")),n=_.min(_(e.end,"HH:mm"),_(t.end,"HH:mm"));a.isBefore(n)&&o.push({start:a.format("HH:mm"),end:n.format("HH:mm")})})})}let r=function(e){if(!e||0===e.length)return[];e.sort((e,t)=>_(e.start,"HH:mm").diff(_(t.start,"HH:mm")));let t=[e[0]];for(let a=1;a<e.length;a++){let n=t[t.length-1],i=e[a];_(n.end,"HH:mm").isSameOrAfter(_(i.start,"HH:mm"))?n.end=_.max(_(n.end,"HH:mm"),_(i.end,"HH:mm")).format("HH:mm"):t.push(i)}return t}(o),c=[],m=_.duration(i).asMinutes(),d=_.duration(s).asMinutes(),p=m+d;console.log(m);let u=_().isSame(n,"day"),h=_().add(2,"hours");return r.forEach(e=>{let t=_(e.start,"HH:mm"),a=_(e.end,"HH:mm");for(;t.clone().add(p,"minutes").isSameOrBefore(a);){let e=t.clone().add(d,"minutes");(!u||u&&e.isAfter(h))&&c.push(e.toDate()),t.add(15,"minutes")}}),c}(Y,P,ee,f,Q,"00:15"))};e();let t=setInterval(()=>{e()},6e4);return()=>clearInterval(t)},[f,Y,P,ee,Q]),(0,o.useEffect)(()=>{if(H[0]){let e=_(H[0]),t=e.clone().add(Q,"minutes");S(H[0]),X("".concat(e.format("HH:mm")," to ").concat(t.format("HH:mm")))}else X("")},[H,Q]);let ea=async()=>{try{let t=await fetch("".concat(e,"/create_meeting2"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration:Q,mode:z,priority:ee,date:f,time:G,booked_by:{email:q,name:W,phone:K},booked_to:{member_email:T,member_name:C,member_phone:E},detail:I})});if(200===t.status){let e=await t.json();en(),alert("Meeting Requent Sent !"),a.push("/mymeeting?".concat(e.id))}else{let e=await t.json();alert(e.error),console.log(e)}}catch(e){alert(e)}},en=async()=>{try{let t=await fetch("".concat(e,"/email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_type:"request",date:f,time:G,booked_by:{email:q,name:W,phone:K},booked_to:{member_email:T,member_name:C,member_phone:E},mode:z,detail:I})});if(200===t.status);else{let e=await t.json();alert(e.error),console.log(e)}}catch(e){alert(e)}},ei=e=>{let t=_(e),a=t.clone().add(Q,"minutes");return"".concat(t.format("HH:mm")," to ").concat(a.format("HH:mm"))},es=e=>b.some(t=>t.getTime()===e.getTime());return(0,n.jsxs)("main",{className:s().main,children:[(0,n.jsx)(l.Z,{}),(0,n.jsx)("div",{className:s().mcontainer,children:(0,n.jsx)("div",{className:s().boxes,children:(0,n.jsxs)("div",{className:s().container,children:[(0,n.jsxs)("div",{className:s().member,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Meeting With"}),(0,n.jsx)(m.ZP,{options:h,value:h.find(e=>e.value===i),onChange:e=>{let t=e?e.value:"";r(t),y(t),N(e.label),O(e.email),M(e.number),F(e.detail||[])},isClearable:!0,placeholder:"Select a Person...",styles:u,className:s().dn})]}),(0,n.jsxs)("div",{className:s().service,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Duration"}),(0,n.jsxs)("select",{name:"duration",id:"duration",onChange:e=>{V(e.target.value)},children:[(0,n.jsx)("option",{value:"00:15",children:"15 minutes"}),(0,n.jsx)("option",{value:"00:30",children:"30 minutes"}),(0,n.jsx)("option",{value:"00:45",children:"45 minutes"}),(0,n.jsx)("option",{value:"01:00",children:"1 hour"}),(0,n.jsx)("option",{value:"01:30",children:"1 hour 30 minutes"}),(0,n.jsx)("option",{value:"02:00",children:"2 hours"}),(0,n.jsx)("option",{value:"03:00",children:"3 hours"}),(0,n.jsx)("option",{value:"04:00",children:"4 hours"})]})]}),(0,n.jsxs)("div",{className:s().service,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Priority"}),(0,n.jsxs)("select",{name:"priority",id:"priority",onChange:e=>{et(e.target.value)},children:[(0,n.jsx)("option",{value:"both",children:"Both"}),(0,n.jsx)("option",{value:"me",children:"Me"}),(0,n.jsx)("option",{value:"member",children:"Meeting with person"})]})]}),(0,n.jsxs)("div",{className:s().service,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Mode"}),(0,n.jsxs)("select",{name:"mode",id:"mode",onChange:e=>{L(e.target.value)},children:[(0,n.jsx)("option",{value:"offline",children:"Offline"}),(0,n.jsx)("option",{value:"online",children:"Online"})]})]}),(0,n.jsxs)("div",{className:s().date,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Date"}),(0,n.jsx)("div",{className:s().dt,children:(0,n.jsx)(c(),{id:"datePicker",selected:f,onChange:e=>{g(e.toISOString().split("T")[0])},dateFormat:"yyyy-MM-dd",minDate:t,maxDate:v,includeDates:b,className:s().DatePicker})})]}),(0,n.jsxs)("div",{className:s().time,children:[(0,n.jsx)("p",{children:"Time"}),(0,n.jsxs)("div",{className:s().timePickerContainer,children:[(0,n.jsx)("div",{className:s().selectedTimeDisplay,onClick:()=>{$(!U)},children:j?(0,n.jsx)("h4",{children:ei(j)}):(0,n.jsx)("h4",{children:"No Slots"})}),(0,n.jsx)("div",{className:s().timeGrid,style:U?{transform:"scale(1)"}:{},children:H.map((e,t)=>(0,n.jsx)("button",{className:"".concat(s().timeSlot," ").concat(j===e?s().selected:""),onClick:()=>{S(e),X(_(e).format("HH:mm")),$(!1)},children:ei(e)},t))})]})]}),(0,n.jsxs)("div",{className:s().des,onClick:()=>{$(!1)},children:[(0,n.jsx)("p",{children:"Detail"}),(0,n.jsx)("textarea",{value:I,onChange:e=>{J(e.target.value)},placeholder:"Meeting Description",rows:"5",cols:"60 name=description"})]}),(0,n.jsx)("button",{className:s().btn,onClick:()=>{""!=D?es(new Date(f))?ea():alert("Date is not valid !"):alert("Enter all needed details..")},children:"Create"})]})})})]})}},10694:function(e){e.exports={main:"newapp_main__6EPDi",mcontainer:"newapp_mcontainer__xPmJQ",container:"newapp_container__SBDlA",date:"newapp_date__XK3KY",dt:"newapp_dt__mVy38",DatePicker:"newapp_DatePicker__HnYka",member:"newapp_member__gTbY2",dn:"newapp_dn__r6c8H",time:"newapp_time__r148X",service:"newapp_service__wJuhk",des:"newapp_des__fcyZl",slot:"newapp_slot__IQwqu",btn:"newapp_btn__7sHXD",option:"newapp_option__3zdTZ",service_detail:"newapp_service_detail__XsW0p",box:"newapp_box__Lu1BR",timePickerContainer:"newapp_timePickerContainer__7Ct5H",timeGrid:"newapp_timeGrid__IlF6l",timeSlot:"newapp_timeSlot__jSeRg",selected:"newapp_selected__BAqjO",selectedTimeDisplay:"newapp_selectedTimeDisplay__bEYqB",name:"newapp_name__WhuHY",place:"newapp_place__FO4mD",mode:"newapp_mode__BTSlc",ni:"newapp_ni__jYWKw",Datepicker:"newapp_Datepicker__qY_vG",tdn:"newapp_tdn__iMK0O",toggle:"newapp_toggle__kJBql",labels:"newapp_labels__zW9Li",slider:"newapp_slider___Q_Dp",mi:"newapp_mi__abrIb",drop:"newapp_drop__kV_dh",inbox:"newapp_inbox__7Z6Sd",check:"newapp_check__ttJOW",conbtn:"newapp_conbtn__r8sC1",canbtn:"newapp_canbtn__uaTSi",timepick:"newapp_timepick__COnFF",timepickin:"newapp_timepickin__K0aU2",bar:"newapp_bar__0tDJE",seltime:"newapp_seltime__mMVbd",morning:"newapp_morning__c68pw",line:"newapp_line__Fa_3i",timeslot:"newapp_timeslot__UgoS3"}}},function(e){e.O(0,[583,611,360,990,605,878,652,202,220,512,971,117,744],function(){return e(e.s=21052)}),_N_E=e.O()}]);