(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{44944:function(e,t,a){Promise.resolve().then(a.bind(a,28491))},28491:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(57437);a(33145);var s=a(9664),i=a.n(s),o=a(2265),l=a(64131),r=a(80605),c=a(99376),d=a(16512);function h(){let e="https://appointment.paruluniversity.ac.in/back",t=(0,r.useSession)(),a=(0,c.useRouter)(),[s,h]=(0,o.useState)(""),[u,p]=(0,o.useState)(0),[m,x]=(0,o.useState)([]),[j,b]=(0,o.useState)([]),[_,v]=(0,o.useState)([]),[y,k]=(0,o.useState)("");(0,o.useEffect)(()=>{let e=l.Z.get("token");console.log(t.status),"authenticated"===t.status&&e&&h(t.data.user.email)}),(0,o.useEffect)(()=>{""!=s&&f(s)},[s]);let f=async t=>{try{let n=await fetch("".concat(e,"/check_admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(200===n.status){let e=await n.json();e.level<2?(alert(e.level),a.push("/")):w()}else alert("nt found"),a.push("/")}catch(e){alert("error"),a.push("/")}},w=async()=>{try{let t=await fetch("".concat(e,"/get_admin_data"),{method:"GET"});if(!t.ok)throw Error("Error: ".concat(t.status," - ").concat(t.statusText));let a=await t.json();a&&(x(a.users),b(a.users),v(a.meetings))}catch(e){console.error("Fetch Error:",e),alert("An error occurred: ".concat(e.message))}},g=async t=>{try{let a=await fetch("".concat(e,"/approve"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(200===a.status)alert("Data is Updated"),window.location.reload();else{let e=await a.json();alert("ok"+e.error)}}catch(e){alert("2"+e)}},N=async t=>{try{let a=await fetch("".concat(e,"/level"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:y,level:t})});if(200===a.status)alert("Data is Updated"),window.location.reload();else{let e=await a.json();alert("ok"+e.error)}}catch(e){alert("2"+e)}},S=async t=>{try{let a=await fetch("".concat(e,"/user_delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(200===a.status)alert("Data is Updated"),window.location.reload();else{let e=await a.json();alert("ok"+e.error)}}catch(e){alert("2"+e)}};return(0,n.jsxs)("main",{className:i().main,children:[(0,n.jsx)(d.Z,{}),(0,n.jsxs)("div",{className:i().menu,children:[(0,n.jsx)("button",{className:0==u?i().active:"",onClick:()=>{p(0)},children:"New Requests"}),(0,n.jsx)("button",{className:1==u?i().active:"",onClick:()=>{p(1)},children:"Users"}),(0,n.jsx)("button",{className:2==u?i().active:"",onClick:()=>{p(2)},children:"Meetings"})]}),(0,n.jsxs)("div",{className:i().boxdiv,children:[0==u&&m.map(e=>e.active?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)("div",{className:i().box,children:[(0,n.jsxs)("p",{children:["Name : ",e.name]}),(0,n.jsxs)("p",{children:["Email : ",e.email]}),(0,n.jsxs)("p",{children:["Phone : ",e.number]}),(0,n.jsxs)("p",{children:["Institute : ",e.institute]}),(0,n.jsxs)("p",{children:["Department : ",e.department]}),(0,n.jsxs)("p",{children:["Position : ",e.position]}),(0,n.jsx)("button",{style:{background:"green"},onClick:()=>{g(e.email)},children:"Approve"}),(0,n.jsx)("button",{children:"Delete"})]})),1==u&&m.map(e=>e.active?(0,n.jsxs)("div",{className:i().box,children:[(0,n.jsxs)("p",{children:["Name : ",e.name]}),(0,n.jsxs)("p",{children:["Email : ",e.email]}),(0,n.jsxs)("p",{children:["Phone : ",e.number]}),(0,n.jsxs)("p",{children:["Institute : ",e.institute]}),(0,n.jsxs)("p",{children:["Department : ",e.department]}),(0,n.jsxs)("p",{children:["Position : ",e.position]}),(0,n.jsxs)("p",{children:["Type  : ",(0,n.jsxs)("select",{value:e.level,onChange:t=>{k(e.email);let a=Number(t.target.value);x(m.map(t=>t._id===e._id?{...t,level:a}:t))},children:[(0,n.jsx)("option",{value:0,children:"normal"}),(0,n.jsx)("option",{value:1,children:"elite"}),(0,n.jsx)("option",{value:2,children:"admin"}),(0,n.jsx)("option",{value:3,children:"super"})]})]}),(0,n.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete user ".concat(e.name,"?"))&&S(e.email)},children:"Delete"}),y==e.email&&(0,n.jsx)("button",{style:{background:"green"},onClick:()=>{N(e.level)},children:"Save"}),y==e.email&&(0,n.jsx)("button",{onClick:()=>{k(""),x(j)},children:"Cancel"})]}):(0,n.jsx)(n.Fragment,{})),2==u&&_.map(e=>(0,n.jsxs)("div",{className:i().box,children:[(0,n.jsxs)("p",{children:["Booked By Name : ",e.booked_by_name]}),(0,n.jsxs)("p",{children:["Booked To Name : ",e.booked_to_name]}),(0,n.jsxs)("p",{children:["Booked By Email : ",e.booked_by]}),(0,n.jsxs)("p",{children:["Booked To Email : ",e.booked_to]}),(0,n.jsxs)("p",{children:["Booked By Phone : ",e.booked_by_phone]}),(0,n.jsxs)("p",{children:["Booked To Phone : ",e.booked_to_phone]}),(0,n.jsxs)("p",{children:["Meeting Date : ",e.date]}),(0,n.jsxs)("p",{children:["Meeting Time : ",e.time]}),(0,n.jsxs)("p",{children:["Meeting Duration : ",e.duration]}),(0,n.jsxs)("p",{children:["Meeting Details : ",e.detail]})]}))]})]})}},9664:function(e){e.exports={main:"head_main__iiovw",menu:"head_menu__OYBmP",active:"head_active__7dct4",boxdiv:"head_boxdiv__ZzGFr",box:"head_box__mVpm9"}}},function(e){e.O(0,[299,611,605,878,652,512,971,117,744],function(){return e(e.s=44944)}),_N_E=e.O()}]);